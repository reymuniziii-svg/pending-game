import type { GameEvent, EventChain } from '@/types'

// ============ FATIMA ASYLUM DEEP DECISION CHAINS ============
// V2: Deep branching narratives with 4-8 event depth

export const FATIMA_CHAIN_EVENTS: GameEvent[] = [
  // === CHAIN 1: THE ASYLUM HEARING (8 events deep) ===
  {
    id: 'fatima_chain_hearing_notice',
    title: 'The Date',
    description: 'After three years and seven months of waiting, the notice arrives. Your asylum hearing has been scheduled. Six weeks from now, you will tell your story to a judge who will decide if you can stay.',
    sceneType: 'home',
    interruptPriority: 'critical',
    timing: { type: 'random', earliestMonth: 36, latestMonth: 72 },
    conditions: [
      { type: 'character', target: 'id', operator: '==', value: 'fatima' },
      { type: 'flag', target: 'hearing_scheduled', operator: 'not-exists', value: true },
    ],
    weight: 70,
    characterIds: ['fatima'],
    chainId: 'fatima_asylum_hearing',
    chainPosition: 1,
    isChainStart: true,
    choices: [
      {
        id: 'prepare_thoroughly',
        text: 'Begin intensive preparation with your lawyer',
        costs: [{ type: 'money', amount: 2000, description: 'Legal preparation fees' }],
        outcomes: [
          { type: 'finance-subtract', target: 'Hearing Preparation', value: 2000 },
          { type: 'flag-set', target: 'hearing_scheduled', value: true },
          { type: 'flag-set', target: 'thorough_preparation', value: true },
          { type: 'stat-change', target: 'stress', value: 30 },
        ],
        outcomeText: 'Your lawyer schedules practice sessions. "You\'ll need to tell your story clearly, consistently. Every detail matters. The judge will be looking for inconsistencies."',
        nextEventId: 'fatima_chain_preparation',
        isRecommended: true,
      },
      {
        id: 'minimal_prep',
        text: 'Trust your story to speak for itself',
        outcomes: [
          { type: 'flag-set', target: 'hearing_scheduled', value: true },
          { type: 'flag-set', target: 'minimal_preparation', value: true },
          { type: 'stat-change', target: 'stress', value: 20 },
        ],
        outcomeText: 'You know what happened. You lived it. How hard can it be to tell the truth? But as the date approaches, anxiety creeps in. What if truth isn\'t enough?',
        nextEventId: 'fatima_chain_eve_of_hearing',
      },
    ],
    tags: ['asylum', 'court', 'preparation', 'critical'],
    isRepeatable: false,
    isMandatory: false,
    priority: 10,
  },
  {
    id: 'fatima_chain_preparation',
    title: 'Remembering',
    description: 'Your lawyer asks you to write down everything. Every threat. Every fear. Every reason you left. The memories you\'ve tried to bury come flooding back.',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_asylum_hearing',
    chainPosition: 2,
    choices: [
      {
        id: 'write_everything',
        text: 'Write down every detail, no matter how painful',
        outcomes: [
          { type: 'flag-set', target: 'complete_declaration', value: true },
          { type: 'stat-change', target: 'stress', value: 30 },
          { type: 'stat-change', target: 'health', value: -10 },
        ],
        outcomeText: 'You stay up until 3 AM. The night they came to your house. The interrogation room. Your colleague who disappeared. Writing it down makes it real again. You can barely breathe by the end.',
        nextEventId: 'fatima_chain_country_evidence',
      },
      {
        id: 'surface_level',
        text: 'Write what\'s necessary, protect yourself from the rest',
        outcomes: [
          { type: 'flag-set', target: 'partial_declaration', value: true },
          { type: 'stat-change', target: 'stress', value: 15 },
        ],
        outcomeText: 'You give the broad outlines. Persecution. Fear. Flight. Your lawyer frowns. "We need more detail. The judge needs to understand why you can\'t go back."',
        nextEventId: 'fatima_chain_country_evidence',
      },
    ],
    tags: ['asylum', 'trauma', 'preparation'],
    isRepeatable: false,
    isMandatory: false,
    priority: 8,
  },
  {
    id: 'fatima_chain_country_evidence',
    title: 'Country Conditions',
    description: 'Your lawyer gathers evidence about conditions in Eritrea. Reports from Human Rights Watch. State Department assessments. News articles about journalists who disappeared.',
    sceneType: 'work',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_asylum_hearing',
    chainPosition: 3,
    choices: [
      {
        id: 'expert_witness',
        text: 'Hire a country conditions expert to testify',
        costs: [{ type: 'money', amount: 1500, description: 'Expert witness fee' }],
        outcomes: [
          { type: 'finance-subtract', target: 'Expert Witness', value: 1500 },
          { type: 'flag-set', target: 'has_expert_witness', value: true },
          { type: 'stat-change', target: 'stress', value: -10 },
        ],
        outcomeText: 'Dr. Tesfay has testified in dozens of Eritrean asylum cases. She can explain to the judge what happens to people like you if they\'re deported. Her credibility might be what saves you.',
        nextEventId: 'fatima_chain_eve_of_hearing',
        isRecommended: true,
      },
      {
        id: 'documents_only',
        text: 'Rely on written documentation',
        outcomes: [
          { type: 'flag-set', target: 'documents_only', value: true },
          { type: 'stat-change', target: 'stress', value: 10 },
        ],
        outcomeText: 'The reports speak for themselves: indefinite military conscription, no free press, political prisoners. But words on paper don\'t have the impact of a live witness.',
        nextEventId: 'fatima_chain_eve_of_hearing',
      },
    ],
    tags: ['asylum', 'evidence', 'preparation'],
    isRepeatable: false,
    isMandatory: false,
    priority: 7,
  },
  {
    id: 'fatima_chain_eve_of_hearing',
    title: 'The Night Before',
    description: 'Tomorrow, your fate will be decided. You lie awake, practicing answers, imagining questions, thinking about what happens if you fail.',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_asylum_hearing',
    chainPosition: 4,
    choices: [
      {
        id: 'try_to_sleep',
        text: 'Try to sleep—you need to be sharp tomorrow',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 15 },
          { type: 'flag-set', target: 'rested_for_hearing', value: true },
        ],
        outcomeText: 'You close your eyes. Sleep comes in fragments. Dreams of home. Of running. Of a judge\'s gavel. When the alarm rings, you\'ve managed maybe three hours.',
      },
      {
        id: 'pray',
        text: 'Spend the night in prayer',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: -10 },
          { type: 'flag-set', target: 'prayed_before_hearing', value: true },
        ],
        outcomeText: 'You pray until dawn. For strength. For words. For a judge who will see you as human. By morning, you feel something close to peace. Whatever happens, you\'ve done what you could.',
        isRecommended: true,
      },
    ],
    tags: ['asylum', 'emotional', 'preparation'],
    isRepeatable: false,
    isMandatory: false,
    priority: 7,
  },
  {
    id: 'fatima_chain_hearing_day',
    title: 'The Hearing',
    description: 'Immigration Court. The room is smaller than you expected. The judge sits behind a raised desk. The government attorney is ready to argue that you don\'t deserve protection.',
    sceneType: 'court',
    interruptPriority: 'critical',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_asylum_hearing',
    chainPosition: 5,
    choices: [
      {
        id: 'tell_story',
        text: 'Tell your story',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 40 },
        ],
        outcomeText: 'You speak. About the newspaper. About the articles you wrote. About the night soldiers came to your door. Your voice shakes. You force yourself to continue.',
        nextEventId: 'fatima_chain_cross_examination',
      },
    ],
    tags: ['asylum', 'court', 'testimony', 'critical'],
    isRepeatable: false,
    isMandatory: false,
    priority: 10,
  },
  {
    id: 'fatima_chain_cross_examination',
    title: 'Cross-Examination',
    description: 'The government attorney rises. "Ms. Haile, you claim you were persecuted for your journalism. But your articles were just about local businesses, weren\'t they?"',
    sceneType: 'court',
    interruptPriority: 'critical',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_asylum_hearing',
    chainPosition: 6,
    variants: [
      {
        condition: { type: 'flag', target: 'complete_declaration', operator: '==', value: true },
        descriptionOverride: 'The government attorney rises, but you\'ve prepared for this. Every detail in your declaration is ready to defend.',
      },
    ],
    choices: [
      {
        id: 'stay_calm',
        text: 'Stay calm and answer precisely',
        requirements: [{ type: 'flag', target: 'thorough_preparation', operator: '==', value: true }],
        outcomes: [
          { type: 'flag-set', target: 'good_testimony', value: true },
          { type: 'stat-change', target: 'stress', value: 20 },
        ],
        outcomeText: '"The articles that caused problems weren\'t published. I was investigating government corruption. The editor was arrested. I have documentation." Your preparation pays off.',
        nextEventId: 'fatima_chain_decision',
      },
      {
        id: 'struggle_to_answer',
        text: 'Struggle to answer the rapid questions',
        requirements: [{ type: 'flag', target: 'minimal_preparation', operator: '==', value: true }],
        outcomes: [
          { type: 'flag-set', target: 'poor_testimony', value: true },
          { type: 'stat-change', target: 'stress', value: 40 },
        ],
        outcomeText: '"I... the dates... I\'m not sure..." The attorney presses harder. Your lawyer objects but the damage is done. The judge is taking notes. You can\'t read their expression.',
        nextEventId: 'fatima_chain_decision',
      },
    ],
    tags: ['asylum', 'court', 'testimony'],
    isRepeatable: false,
    isMandatory: false,
    priority: 10,
  },
  {
    id: 'fatima_chain_decision',
    title: 'The Verdict',
    description: 'The judge shuffles papers. Reviews notes. The courtroom is silent. "In the matter of Fatima Haile versus the Department of Homeland Security..."',
    sceneType: 'court',
    interruptPriority: 'critical',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_asylum_hearing',
    chainPosition: 7,
    choices: [
      {
        id: 'granted',
        text: 'The judge continues...',
        requirements: [{ type: 'flag', target: 'good_testimony', operator: '==', value: true }],
        outcomes: [
          { type: 'status-change', target: 'asylum-granted', value: true },
          { type: 'flag-set', target: 'asylum_granted', value: true },
          { type: 'stat-change', target: 'stress', value: -50 },
        ],
        outcomeText: '"I find the respondent\'s testimony credible. The country conditions evidence supports her claim. Asylum is GRANTED." The gavel falls. Your lawyer squeezes your hand. You can\'t hear anything over your own sobbing.',
      },
      {
        id: 'denied',
        text: 'The judge continues...',
        requirements: [{ type: 'flag', target: 'poor_testimony', operator: '==', value: true }],
        outcomes: [
          { type: 'flag-set', target: 'asylum_denied', value: true },
          { type: 'stat-change', target: 'stress', value: 50 },
        ],
        outcomeText: '"I find inconsistencies in the respondent\'s testimony. The claim for asylum is DENIED. Removal proceedings will continue." The room spins. Your lawyer whispers: "We can appeal."',
        nextEventId: 'fatima_chain_appeal_decision',
        probability: 0.6,
      },
      {
        id: 'granted_despite',
        text: 'The judge continues...',
        requirements: [{ type: 'flag', target: 'has_expert_witness', operator: '==', value: true }],
        outcomes: [
          { type: 'status-change', target: 'asylum-granted', value: true },
          { type: 'flag-set', target: 'asylum_granted', value: true },
          { type: 'stat-change', target: 'stress', value: -40 },
        ],
        outcomeText: '"While there were some inconsistencies, the expert testimony on country conditions was compelling. I find that returning the respondent would likely result in persecution. Asylum is GRANTED."',
        probability: 0.4,
      },
    ],
    tags: ['asylum', 'decision', 'critical', 'climax'],
    isRepeatable: false,
    isMandatory: false,
    priority: 10,
  },
  {
    id: 'fatima_chain_appeal_decision',
    title: 'The Appeal',
    description: 'You have 30 days to file an appeal with the Board of Immigration Appeals. Another $2,000 in legal fees. Another year of waiting.',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_asylum_hearing',
    chainPosition: 8,
    choices: [
      {
        id: 'file_appeal',
        text: 'File the appeal',
        costs: [{ type: 'money', amount: 2000, description: 'Appeal fees' }],
        outcomes: [
          { type: 'finance-subtract', target: 'BIA Appeal', value: 2000 },
          { type: 'flag-set', target: 'appealing_decision', value: true },
          { type: 'stat-change', target: 'stress', value: 30 },
        ],
        outcomeText: 'You borrow money from Miriam. From your church community. File the appeal on day 29. Another year of limbo. But at least you\'re still here, still fighting.',
      },
      {
        id: 'accept_defeat',
        text: 'Accept the decision',
        outcomes: [
          { type: 'flag-set', target: 'accepted_denial', value: true },
          { type: 'stat-change', target: 'stress', value: 40 },
        ],
        outcomeText: 'You have no money left. No energy. You sign the voluntary departure papers. At least this way, you can leave with dignity, not in handcuffs.',
        nextEventId: 'fatima_chain_voluntary_departure',
      },
    ],
    tags: ['asylum', 'appeal', 'decision'],
    isRepeatable: false,
    isMandatory: false,
    priority: 9,
  },

  // === CHAIN 2: FAMILY IN DANGER (5 events deep) ===
  {
    id: 'fatima_chain_family_danger_start',
    title: 'News from Home',
    description: 'A message from your brother, the first in months. "They came asking about you. They know you\'re in America. Our mother... they\'re using her to find you."',
    sceneType: 'home',
    interruptPriority: 'critical',
    timing: { type: 'random', earliestMonth: 12, latestMonth: 48 },
    conditions: [
      { type: 'character', target: 'id', operator: '==', value: 'fatima' },
      { type: 'flag', target: 'family_threatened', operator: 'not-exists', value: true },
    ],
    weight: 35,
    characterIds: ['fatima'],
    chainId: 'fatima_family_danger',
    chainPosition: 1,
    isChainStart: true,
    choices: [
      {
        id: 'cut_contact',
        text: 'Cut all contact to protect them',
        outcomes: [
          { type: 'flag-set', target: 'family_threatened', value: true },
          { type: 'flag-set', target: 'cut_family_contact', value: true },
          { type: 'stat-change', target: 'stress', value: 35 },
          { type: 'stat-change', target: 'communityConnection', value: -15 },
        ],
        outcomeText: 'You delete the messaging apps. Stop checking for news. Every message you send could be traced. Your silence is the only protection you can offer.',
        nextEventId: 'fatima_chain_silence',
      },
      {
        id: 'help_escape',
        text: 'Try to help them escape',
        outcomes: [
          { type: 'flag-set', target: 'family_threatened', value: true },
          { type: 'flag-set', target: 'helping_family_escape', value: true },
          { type: 'stat-change', target: 'stress', value: 40 },
        ],
        outcomeText: 'You start researching refugee camps in Sudan. Smugglers who can get people across the border. It would cost everything you have and more. But your mother...',
        nextEventId: 'fatima_chain_escape_planning',
      },
    ],
    tags: ['family', 'danger', 'critical', 'emotional'],
    isRepeatable: false,
    isMandatory: false,
    priority: 9,
  },
  {
    id: 'fatima_chain_escape_planning',
    title: 'The Price of Escape',
    description: 'A contact in Sudan quotes a price: $5,000 to get your mother to a refugee camp. No guarantees. High risk. The desert crossing kills many.',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_family_danger',
    chainPosition: 2,
    choices: [
      {
        id: 'pay_smuggler',
        text: 'Find a way to pay',
        costs: [{ type: 'money', amount: 5000, description: 'Smuggler fee' }],
        outcomes: [
          { type: 'finance-subtract', target: 'Escape Fee', value: 5000 },
          { type: 'flag-set', target: 'paid_for_escape', value: true },
          { type: 'stat-change', target: 'stress', value: 30 },
        ],
        outcomeText: 'You borrow from Miriam. From your church. From coworkers who barely know your story. Wire the money to a stranger in Khartoum. And wait.',
        nextEventId: 'fatima_chain_escape_result',
      },
      {
        id: 'cant_afford',
        text: 'You don\'t have that kind of money',
        outcomes: [
          { type: 'flag-set', target: 'couldnt_help_escape', value: true },
          { type: 'stat-change', target: 'stress', value: 45 },
          { type: 'stat-change', target: 'health', value: -15 },
        ],
        outcomeText: 'You have $800 in savings. The math doesn\'t work. You send what you can and pray it\'s enough for something. Food. Bribes. Anything.',
        nextEventId: 'fatima_chain_helpless',
      },
    ],
    tags: ['family', 'money', 'escape', 'decision'],
    isRepeatable: false,
    isMandatory: false,
    priority: 9,
  },
  {
    id: 'fatima_chain_escape_result',
    title: 'The Crossing',
    description: 'Weeks of silence. Then a message from an unknown number: "We made it to the camp. Your mother is safe."',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_family_danger',
    chainPosition: 3,
    choices: [
      {
        id: 'relief',
        text: 'Breathe again',
        outcomes: [
          { type: 'flag-set', target: 'mother_safe', value: true },
          { type: 'stat-change', target: 'stress', value: -30 },
          { type: 'stat-change', target: 'health', value: 10 },
        ],
        outcomeText: 'She\'s alive. In a UN refugee camp in Sudan. Not safe—but safer. You video call and see her face for the first time in two years. Both of you cry too hard to speak.',
        probability: 0.7,
      },
      {
        id: 'tragedy',
        text: 'The message continues...',
        outcomes: [
          { type: 'flag-set', target: 'mother_died_crossing', value: true },
          { type: 'stat-change', target: 'stress', value: 50 },
          { type: 'stat-change', target: 'health', value: -25 },
        ],
        outcomeText: '"Your mother did not survive the crossing. She passed three days ago. I am sorry." The phone slips from your hand. The world ends quietly, with a text message.',
        probability: 0.3,
      },
    ],
    tags: ['family', 'rescue', 'emotional', 'critical'],
    isRepeatable: false,
    isMandatory: false,
    priority: 10,
  },
  {
    id: 'fatima_chain_silence',
    title: 'The Silence',
    description: 'Six months without contact. You don\'t know if your family is safe, imprisoned, or dead. The not-knowing is its own torture.',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_family_danger',
    chainPosition: 2,
    choices: [
      {
        id: 'accept_uncertainty',
        text: 'Learn to live with not knowing',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 20 },
          { type: 'flag-set', target: 'living_with_uncertainty', value: true },
        ],
        outcomeText: 'You go to therapy. Join a support group for refugees. Learn that you\'re not alone in this particular grief—the grief of not knowing. It doesn\'t fix anything, but it helps.',
        isRecommended: true,
      },
      {
        id: 'obsess',
        text: 'Search constantly for any information',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 35 },
          { type: 'stat-change', target: 'health', value: -10 },
        ],
        outcomeText: 'You scour news sites, social media, diaspora message boards. Every story of arrest. Every rumor of detention. You don\'t find your family. You find only more fear.',
      },
    ],
    tags: ['family', 'emotional', 'uncertainty'],
    isRepeatable: false,
    isMandatory: false,
    priority: 7,
  },
  {
    id: 'fatima_chain_helpless',
    title: 'Helpless',
    description: 'Your mother is in danger, and you can do nothing. You are safe in America, and you can do nothing. The guilt is crushing.',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_family_danger',
    chainPosition: 3,
    choices: [
      {
        id: 'keep_living',
        text: 'Keep living—it\'s what she would want',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 20 },
          { type: 'flag-set', target: 'carrying_survivors_guilt', value: true },
        ],
        outcomeText: 'You go to work. You eat. You breathe. You carry the guilt like a stone in your chest. Maybe someday it will be lighter. Today is not that day.',
      },
    ],
    tags: ['emotional', 'guilt', 'survival'],
    isRepeatable: false,
    isMandatory: false,
    priority: 6,
  },

  // === CHAIN 3: WORK AUTHORIZATION (4 events deep) ===
  {
    id: 'fatima_chain_ead_start',
    title: 'The 180-Day Mark',
    description: 'Your asylum application was filed 180 days ago. You can now apply for work authorization. After six months of depending on charity, you might be able to support yourself.',
    sceneType: 'home',
    timing: { type: 'random', earliestMonth: 6, latestMonth: 12 },
    conditions: [
      { type: 'character', target: 'id', operator: '==', value: 'fatima' },
      { type: 'flag', target: 'ead_eligible', operator: 'not-exists', value: true },
    ],
    weight: 80,
    characterIds: ['fatima'],
    chainId: 'fatima_work_authorization',
    chainPosition: 1,
    isChainStart: true,
    choices: [
      {
        id: 'apply_ead',
        text: 'Apply for the Employment Authorization Document',
        costs: [{ type: 'money', amount: 410, description: 'EAD filing fee' }],
        outcomes: [
          { type: 'finance-subtract', target: 'EAD Application', value: 410 },
          { type: 'flag-set', target: 'ead_eligible', value: true },
          { type: 'flag-set', target: 'ead_applied', value: true },
          { type: 'stat-change', target: 'stress', value: -10 },
        ],
        outcomeText: 'You file the I-765. The fee hurts—Miriam helps you cover it. Processing takes 3-6 months. But maybe, finally, you\'ll be able to work.',
        nextEventId: 'fatima_chain_ead_wait',
      },
      {
        id: 'fee_waiver',
        text: 'Apply for a fee waiver',
        outcomes: [
          { type: 'flag-set', target: 'ead_eligible', value: true },
          { type: 'flag-set', target: 'fee_waiver_requested', value: true },
          { type: 'stat-change', target: 'stress', value: 5 },
        ],
        outcomeText: 'You document your poverty: no income, dependent on charity, asylum seeker. The fee waiver is approved. Now you wait without the financial sting.',
        nextEventId: 'fatima_chain_ead_wait',
        isRecommended: true,
      },
    ],
    tags: ['work', 'ead', 'authorization', 'hope'],
    isRepeatable: false,
    isMandatory: false,
    priority: 7,
  },
  {
    id: 'fatima_chain_ead_wait',
    title: 'Waiting for Work',
    description: 'Another wait. This one for the card that will let you work. You check the case status every day. "Case is being actively reviewed."',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_work_authorization',
    chainPosition: 2,
    choices: [
      {
        id: 'prepare_for_work',
        text: 'Use the time to prepare for employment',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: -5 },
          { type: 'stat-change', target: 'englishProficiency', value: 10 },
          { type: 'flag-set', target: 'prepared_for_work', value: true },
        ],
        outcomeText: 'You attend ESL classes. Update your resume. Research what jobs you might qualify for. Your journalism degree means little here, but you have skills.',
        nextEventId: 'fatima_chain_ead_arrives',
        isRecommended: true,
      },
      {
        id: 'despair',
        text: 'Let the waiting wear you down',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 20 },
          { type: 'stat-change', target: 'health', value: -5 },
        ],
        outcomeText: 'More waiting. Always waiting. Waiting for the hearing. Waiting for the card. Waiting for a life. Some days you don\'t leave Miriam\'s apartment.',
        nextEventId: 'fatima_chain_ead_arrives',
      },
    ],
    tags: ['work', 'waiting', 'preparation'],
    isRepeatable: false,
    isMandatory: false,
    priority: 5,
  },
  {
    id: 'fatima_chain_ead_arrives',
    title: 'The Card Arrives',
    description: 'Four months later. An envelope from USCIS. Inside: a plastic card with your photo. "Employment Authorization." You can work. You can exist.',
    sceneType: 'home',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_work_authorization',
    chainPosition: 3,
    choices: [
      {
        id: 'job_search',
        text: 'Start the job search immediately',
        outcomes: [
          { type: 'flag-set', target: 'has_ead', value: true },
          { type: 'stat-change', target: 'stress', value: -15 },
        ],
        outcomeText: 'You hold the card in your hands. A rectangle of plastic that means dignity. Independence. A chance to stop being a burden. Tomorrow, you apply for jobs.',
        nextEventId: 'fatima_chain_first_job',
      },
    ],
    tags: ['work', 'milestone', 'hope'],
    isRepeatable: false,
    isMandatory: false,
    priority: 7,
  },
  {
    id: 'fatima_chain_first_job',
    title: 'First Paycheck',
    description: 'You find work at a hotel doing housekeeping. $14 an hour. Not journalism. Not what you trained for. But it\'s honest work, and it\'s yours.',
    sceneType: 'work',
    timing: { type: 'triggered' },
    conditions: [],
    weight: 0,
    characterIds: ['fatima'],
    chainId: 'fatima_work_authorization',
    chainPosition: 4,
    choices: [
      {
        id: 'embrace_work',
        text: 'Take pride in earning your own way',
        outcomes: [
          { type: 'flag-set', target: 'employed', value: true },
          { type: 'finance-add', target: 'First Paycheck', value: 1200 },
          { type: 'stat-change', target: 'stress', value: -20 },
          { type: 'stat-change', target: 'communityConnection', value: 10 },
        ],
        outcomeText: 'Your first paycheck: $1,247.63. You\'ve never been happier to see such a small number. You pay Miriam back for groceries. Buy yourself a phone card. You exist again.',
        isRecommended: true,
      },
      {
        id: 'mourn_career',
        text: 'Mourn the career you lost',
        outcomes: [
          { type: 'flag-set', target: 'employed', value: true },
          { type: 'finance-add', target: 'First Paycheck', value: 1200 },
          { type: 'stat-change', target: 'stress', value: 10 },
        ],
        outcomeText: 'You were a journalist. An investigator. Now you change sheets and scrub toilets. The work is not shameful, but grief sits heavy anyway. You clean rooms and remember who you used to be.',
      },
    ],
    tags: ['work', 'milestone', 'identity'],
    isRepeatable: false,
    isMandatory: false,
    priority: 6,
  },

  // === ADDITIONAL STANDALONE EVENTS ===
  {
    id: 'fatima_community_dinner',
    title: 'The Eritrean Community',
    description: 'The local Eritrean church is holding a dinner. You haven\'t been around your own people since you arrived. It feels risky—and necessary.',
    sceneType: 'community',
    timing: { type: 'random', earliestMonth: 6, latestMonth: 36 },
    conditions: [
      { type: 'character', target: 'id', operator: '==', value: 'fatima' },
    ],
    weight: 50,
    characterIds: ['fatima'],
    choices: [
      {
        id: 'attend',
        text: 'Attend the dinner',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: -20 },
          { type: 'stat-change', target: 'communityConnection', value: 20 },
        ],
        outcomeText: 'The smell of injera. The sound of Tigrinya. For a few hours, you\'re not a refugee or an asylum seeker. You\'re just Fatima, surrounded by others who understand.',
        isRecommended: true,
      },
      {
        id: 'avoid',
        text: 'Stay away—you can\'t trust anyone',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 10 },
        ],
        outcomeText: 'The government has informants everywhere. Even among refugees. You can\'t risk someone reporting back that they saw you. Safety requires loneliness.',
      },
    ],
    tags: ['community', 'culture', 'connection'],
    isRepeatable: true,
    isMandatory: false,
    priority: 4,
  },
  {
    id: 'fatima_nightmare',
    title: 'The Dream',
    description: 'You wake at 3 AM, heart pounding. The same dream again. The interrogation room. The questions that never ended. The door that never opened.',
    sceneType: 'home',
    timing: { type: 'random', earliestMonth: 3, latestMonth: 60 },
    conditions: [
      { type: 'character', target: 'id', operator: '==', value: 'fatima' },
    ],
    weight: 55,
    characterIds: ['fatima'],
    choices: [
      {
        id: 'seek_help',
        text: 'Look into trauma counseling',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: -10 },
          { type: 'flag-set', target: 'seeking_therapy', value: true },
        ],
        outcomeText: 'You find a refugee mental health clinic. The therapist speaks Tigrinya. For the first time, you talk about what happened to someone who can help you carry it.',
        isRecommended: true,
      },
      {
        id: 'endure',
        text: 'Push through—this is just how life is now',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 15 },
          { type: 'stat-change', target: 'health', value: -5 },
        ],
        outcomeText: 'You make tea. Stare at the ceiling until dawn. In the morning, you function. That\'s enough. It has to be enough.',
      },
    ],
    tags: ['trauma', 'mental-health', 'survival'],
    isRepeatable: true,
    isMandatory: false,
    priority: 3,
  },
  {
    id: 'fatima_news_from_eritrea',
    title: 'News from Eritrea',
    description: 'A colleague from your newspaper made it to Germany. She reaches out online. "They\'re looking for you specifically. Don\'t ever go back."',
    sceneType: 'home',
    timing: { type: 'random', earliestMonth: 12, latestMonth: 48 },
    conditions: [
      { type: 'character', target: 'id', operator: '==', value: 'fatima' },
    ],
    weight: 40,
    characterIds: ['fatima'],
    choices: [
      {
        id: 'document_evidence',
        text: 'Ask her to document what she knows',
        outcomes: [
          { type: 'flag-set', target: 'corroborating_evidence', value: true },
          { type: 'stat-change', target: 'stress', value: 10 },
        ],
        outcomeText: 'She writes a sworn declaration. Names, dates, what she witnessed. Your lawyer says this could strengthen your case. Evidence that you\'re not lying about the danger.',
        isRecommended: true,
      },
      {
        id: 'dont_involve',
        text: 'Don\'t involve her—it\'s too dangerous',
        outcomes: [
          { type: 'stat-change', target: 'stress', value: 15 },
        ],
        outcomeText: '"I can\'t ask you to take that risk," you tell her. "They have long arms." She understands. Everyone who escaped understands what it means to stay invisible.',
      },
    ],
    tags: ['evidence', 'fear', 'connection'],
    isRepeatable: false,
    isMandatory: false,
    priority: 5,
  },
]

// Event chains for tracking
export const FATIMA_CHAINS: EventChain[] = [
  {
    id: 'fatima_asylum_hearing',
    name: 'The Asylum Hearing',
    description: 'Fatima prepares for and faces her asylum hearing',
    eventIds: [
      'fatima_chain_hearing_notice',
      'fatima_chain_preparation',
      'fatima_chain_country_evidence',
      'fatima_chain_eve_of_hearing',
      'fatima_chain_hearing_day',
      'fatima_chain_cross_examination',
      'fatima_chain_decision',
      'fatima_chain_appeal_decision',
    ],
    currentPosition: 0,
    isInterruptible: false,
    characterIds: ['fatima'],
  },
  {
    id: 'fatima_family_danger',
    name: 'Family in Danger',
    description: 'Fatima\'s family back home faces danger because of her escape',
    eventIds: [
      'fatima_chain_family_danger_start',
      'fatima_chain_escape_planning',
      'fatima_chain_escape_result',
      'fatima_chain_silence',
      'fatima_chain_helpless',
    ],
    currentPosition: 0,
    isInterruptible: true,
    characterIds: ['fatima'],
  },
  {
    id: 'fatima_work_authorization',
    name: 'Work Authorization',
    description: 'Fatima navigates getting work authorization while awaiting asylum',
    eventIds: [
      'fatima_chain_ead_start',
      'fatima_chain_ead_wait',
      'fatima_chain_ead_arrives',
      'fatima_chain_first_job',
    ],
    currentPosition: 0,
    isInterruptible: true,
    characterIds: ['fatima'],
  },
]
